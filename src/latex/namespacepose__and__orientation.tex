\hypertarget{namespacepose__and__orientation}{}\doxysection{pose\+\_\+and\+\_\+orientation Namespace Reference}
\label{namespacepose__and__orientation}\index{pose\_and\_orientation@{pose\_and\_orientation}}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classpose__and__orientation_1_1Input}{Input}}
\item 
class \mbox{\hyperlink{classpose__and__orientation_1_1Output}{Output}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{namespacepose__and__orientation_af0818e26923c7a3ff59f8cc15a99c9a1}{find\+\_\+object}} (image)
\begin{DoxyCompactList}\small\item\em This function computes the largest contour of an image. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacepose__and__orientation_a0823a5809913fbc4c355fe545c4fc795}{draw\+\_\+contour}} (image, contour)
\begin{DoxyCompactList}\small\item\em This function draws a contour on an image. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacepose__and__orientation_a28df90a61288ecc144d64d8330034fd4}{discriminate\+\_\+brick\+\_\+points}} (image, offset)
\begin{DoxyCompactList}\small\item\em The function computes every single point contained in an object exploiting find\+\_\+object and draw\+\_\+contour. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacepose__and__orientation_a2de24ef9ff3a5a41a87ffad7067aca72}{find\+\_\+centroid}} (points)
\begin{DoxyCompactList}\small\item\em This function finds the centroid (centre of mass) of the brick. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacepose__and__orientation_a442e0514c78b25f1b7d1ad16e39f652c}{convert\+\_\+coordinates}} (coordinates, from\+\_\+frame, to\+\_\+frame)
\begin{DoxyCompactList}\small\item\em This function allows to automatically convert a coordinate expressed in a certain frame to another frame. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacepose__and__orientation_a509656a47056d2ef1304dd029fd26d6a}{rotation\+\_\+matrix\+\_\+to\+\_\+euler\+\_\+angles}} (R)
\begin{DoxyCompactList}\small\item\em This function converts a rotation matrix into euler angles (R\+PY). \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacepose__and__orientation_a4caae50b1147e3387534a469ae6e6125}{preprocess\+\_\+point\+\_\+cloud}} (pcd, voxel\+\_\+size)
\begin{DoxyCompactList}\small\item\em This function downsamples the point cloud, estimates normals, then computes a F\+P\+FH feature for each point. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacepose__and__orientation_a2247b4d9578547ab2f2d689761ec7749}{prepare\+\_\+dataset}} (source, target, voxel\+\_\+size)
\begin{DoxyCompactList}\small\item\em This function simply prepares all the pointclouds (the source one and the target one). \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacepose__and__orientation_ad2908815943c6125fd6515ddc1479796}{execute\+\_\+fast\+\_\+global\+\_\+registration}} (source\+\_\+down, target\+\_\+down, source\+\_\+fpfh, target\+\_\+fpfh)
\begin{DoxyCompactList}\small\item\em This executes the actual global registration. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacepose__and__orientation_aec24b06d02e6c9d57fbffd16c683acd4}{icp\+\_\+registration}} (source\+\_\+pointcloud, target\+\_\+pointcloud, threshold, starting\+\_\+transformation)
\begin{DoxyCompactList}\small\item\em This function finds a suitable final registration. \end{DoxyCompactList}\item 
None \mbox{\hyperlink{namespacepose__and__orientation_a68dcad699f72223959ee3de6dd4cc0a7}{object\+\_\+detection}} (Image image\+\_\+msg, Point\+Cloud2 point\+\_\+cloud2\+\_\+msg, inputs)
\begin{DoxyCompactList}\small\item\em The function finds the position of the object with respect to the world frame. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{namespacepose__and__orientation_adbaacadc086fe0a85fa78a58e55ad48a}\label{namespacepose__and__orientation_adbaacadc086fe0a85fa78a58e55ad48a}} 
list {\bfseries bricks\+\_\+information} = \mbox{[}$\,$\mbox{]}
\item 
\mbox{\Hypertarget{namespacepose__and__orientation_a61be6793471d7bc9ea89799b6b4db21e}\label{namespacepose__and__orientation_a61be6793471d7bc9ea89799b6b4db21e}} 
float {\bfseries D\+I\+M\+\_\+\+B\+L\+O\+CK} = 0.\+03
\item 
\mbox{\Hypertarget{namespacepose__and__orientation_a94a6f066f65f41d93ae367663372f42f}\label{namespacepose__and__orientation_a94a6f066f65f41d93ae367663372f42f}} 
int {\bfseries C\+R\+O\+P\+P\+I\+N\+G\+\_\+\+O\+F\+F\+S\+ET} = 10
\item 
\mbox{\Hypertarget{namespacepose__and__orientation_adaa605e3ee6ee83d3372a7f73e967365}\label{namespacepose__and__orientation_adaa605e3ee6ee83d3372a7f73e967365}} 
float {\bfseries threshold} = 0.\+01
\item 
\mbox{\Hypertarget{namespacepose__and__orientation_a8692f4cee70ecc6d0f12487dc871f63b}\label{namespacepose__and__orientation_a8692f4cee70ecc6d0f12487dc871f63b}} 
list {\bfseries inputs} = \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}@file pose_and_orientation.py
@brief A file to convert bounding boxes into poses and orientations.
@date   15/01/2024
@author Jacopo Veronese
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespacepose__and__orientation_a442e0514c78b25f1b7d1ad16e39f652c}\label{namespacepose__and__orientation_a442e0514c78b25f1b7d1ad16e39f652c}} 
\index{pose\_and\_orientation@{pose\_and\_orientation}!convert\_coordinates@{convert\_coordinates}}
\index{convert\_coordinates@{convert\_coordinates}!pose\_and\_orientation@{pose\_and\_orientation}}
\doxysubsubsection{\texorpdfstring{convert\_coordinates()}{convert\_coordinates()}}
{\footnotesize\ttfamily def pose\+\_\+and\+\_\+orientation.\+convert\+\_\+coordinates (\begin{DoxyParamCaption}\item[{}]{coordinates,  }\item[{}]{from\+\_\+frame,  }\item[{}]{to\+\_\+frame }\end{DoxyParamCaption})}



This function allows to automatically convert a coordinate expressed in a certain frame to another frame. 

This is done by listening to the frames published by the R\+OS master.

Inputs\+:
\begin{DoxyItemize}
\item coordinates\+: the coordinates that are needed to be converted
\item from\+\_\+frame\+: initial frame
\item to\+\_\+frame\+: final frame
\end{DoxyItemize}

Outputs\+:
\begin{DoxyItemize}
\item output\+\_\+pose\+\_\+stamped.\+pose\+: pose of the resulting transformed coordinate 
\end{DoxyItemize}\mbox{\Hypertarget{namespacepose__and__orientation_a28df90a61288ecc144d64d8330034fd4}\label{namespacepose__and__orientation_a28df90a61288ecc144d64d8330034fd4}} 
\index{pose\_and\_orientation@{pose\_and\_orientation}!discriminate\_brick\_points@{discriminate\_brick\_points}}
\index{discriminate\_brick\_points@{discriminate\_brick\_points}!pose\_and\_orientation@{pose\_and\_orientation}}
\doxysubsubsection{\texorpdfstring{discriminate\_brick\_points()}{discriminate\_brick\_points()}}
{\footnotesize\ttfamily def pose\+\_\+and\+\_\+orientation.\+discriminate\+\_\+brick\+\_\+points (\begin{DoxyParamCaption}\item[{}]{image,  }\item[{}]{offset }\end{DoxyParamCaption})}



The function computes every single point contained in an object exploiting find\+\_\+object and draw\+\_\+contour. 

The points are found using the largest contour of the image. Hence points that are part of the contour and of the inside of the contour are part of the result.

Inputs\+:
\begin{DoxyItemize}
\item image\+: the image in which the desired object is
\item offset\+: this input allows to re-\/scale a previously cropped image in order to return the real values of the points in the image
\end{DoxyItemize}

Outputs\+:
\begin{DoxyItemize}
\item result\+: all the points that are part of the object 
\end{DoxyItemize}\mbox{\Hypertarget{namespacepose__and__orientation_a0823a5809913fbc4c355fe545c4fc795}\label{namespacepose__and__orientation_a0823a5809913fbc4c355fe545c4fc795}} 
\index{pose\_and\_orientation@{pose\_and\_orientation}!draw\_contour@{draw\_contour}}
\index{draw\_contour@{draw\_contour}!pose\_and\_orientation@{pose\_and\_orientation}}
\doxysubsubsection{\texorpdfstring{draw\_contour()}{draw\_contour()}}
{\footnotesize\ttfamily def pose\+\_\+and\+\_\+orientation.\+draw\+\_\+contour (\begin{DoxyParamCaption}\item[{}]{image,  }\item[{}]{contour }\end{DoxyParamCaption})}



This function draws a contour on an image. 

Inputs\+:
\begin{DoxyItemize}
\item image\+: the image on which the contour is drawn
\end{DoxyItemize}

Outputs\+:
\begin{DoxyItemize}
\item result\+: the contour laid on the image 
\end{DoxyItemize}\mbox{\Hypertarget{namespacepose__and__orientation_ad2908815943c6125fd6515ddc1479796}\label{namespacepose__and__orientation_ad2908815943c6125fd6515ddc1479796}} 
\index{pose\_and\_orientation@{pose\_and\_orientation}!execute\_fast\_global\_registration@{execute\_fast\_global\_registration}}
\index{execute\_fast\_global\_registration@{execute\_fast\_global\_registration}!pose\_and\_orientation@{pose\_and\_orientation}}
\doxysubsubsection{\texorpdfstring{execute\_fast\_global\_registration()}{execute\_fast\_global\_registration()}}
{\footnotesize\ttfamily def pose\+\_\+and\+\_\+orientation.\+execute\+\_\+fast\+\_\+global\+\_\+registration (\begin{DoxyParamCaption}\item[{}]{source\+\_\+down,  }\item[{}]{target\+\_\+down,  }\item[{}]{source\+\_\+fpfh,  }\item[{}]{target\+\_\+fpfh }\end{DoxyParamCaption})}



This executes the actual global registration. 

It performs fast global registration based on feature matching with a specified maximum correspondence distance, and returns the result of the registration. This registration is then used in the icp\+\_\+registration to estimate a more accurate registration.

Inputs\+:
\begin{DoxyItemize}
\item source\+: the source pointcloud
\item target\+: the target pointcloud
\end{DoxyItemize}

Outputs\+:
\begin{DoxyItemize}
\item result\+: the final registration 
\end{DoxyItemize}\mbox{\Hypertarget{namespacepose__and__orientation_a2de24ef9ff3a5a41a87ffad7067aca72}\label{namespacepose__and__orientation_a2de24ef9ff3a5a41a87ffad7067aca72}} 
\index{pose\_and\_orientation@{pose\_and\_orientation}!find\_centroid@{find\_centroid}}
\index{find\_centroid@{find\_centroid}!pose\_and\_orientation@{pose\_and\_orientation}}
\doxysubsubsection{\texorpdfstring{find\_centroid()}{find\_centroid()}}
{\footnotesize\ttfamily def pose\+\_\+and\+\_\+orientation.\+find\+\_\+centroid (\begin{DoxyParamCaption}\item[{}]{points }\end{DoxyParamCaption})}



This function finds the centroid (centre of mass) of the brick. 

Inputs\+:
\begin{DoxyItemize}
\item points\+: the 3D points that are part of the object
\end{DoxyItemize}

Outputs\+:
\begin{DoxyItemize}
\item centroid 
\end{DoxyItemize}\mbox{\Hypertarget{namespacepose__and__orientation_af0818e26923c7a3ff59f8cc15a99c9a1}\label{namespacepose__and__orientation_af0818e26923c7a3ff59f8cc15a99c9a1}} 
\index{pose\_and\_orientation@{pose\_and\_orientation}!find\_object@{find\_object}}
\index{find\_object@{find\_object}!pose\_and\_orientation@{pose\_and\_orientation}}
\doxysubsubsection{\texorpdfstring{find\_object()}{find\_object()}}
{\footnotesize\ttfamily def pose\+\_\+and\+\_\+orientation.\+find\+\_\+object (\begin{DoxyParamCaption}\item[{}]{image }\end{DoxyParamCaption})}



This function computes the largest contour of an image. 

Inputs\+:
\begin{DoxyItemize}
\item image\+: the image on which the computation is performed
\end{DoxyItemize}

Outputs\+:
\begin{DoxyItemize}
\item largest\+\_\+contour\+: the largest contour of the image based on the area 
\end{DoxyItemize}\mbox{\Hypertarget{namespacepose__and__orientation_aec24b06d02e6c9d57fbffd16c683acd4}\label{namespacepose__and__orientation_aec24b06d02e6c9d57fbffd16c683acd4}} 
\index{pose\_and\_orientation@{pose\_and\_orientation}!icp\_registration@{icp\_registration}}
\index{icp\_registration@{icp\_registration}!pose\_and\_orientation@{pose\_and\_orientation}}
\doxysubsubsection{\texorpdfstring{icp\_registration()}{icp\_registration()}}
{\footnotesize\ttfamily def pose\+\_\+and\+\_\+orientation.\+icp\+\_\+registration (\begin{DoxyParamCaption}\item[{}]{source\+\_\+pointcloud,  }\item[{}]{target\+\_\+pointcloud,  }\item[{}]{threshold,  }\item[{}]{starting\+\_\+transformation }\end{DoxyParamCaption})}



This function finds a suitable final registration. 

Inputs\+:
\begin{DoxyItemize}
\item source\+\_\+pointcloud
\item target\+\_\+pointcloud
\item threshold\+: the maximum correspondence distance for a point pair to be considered an inlier during the process.
\item starting transformation\+: the initial transformation coming from the global registration
\end{DoxyItemize}

Outputs\+:
\begin{DoxyItemize}
\item 
\item 
\end{DoxyItemize}\mbox{\Hypertarget{namespacepose__and__orientation_a68dcad699f72223959ee3de6dd4cc0a7}\label{namespacepose__and__orientation_a68dcad699f72223959ee3de6dd4cc0a7}} 
\index{pose\_and\_orientation@{pose\_and\_orientation}!object\_detection@{object\_detection}}
\index{object\_detection@{object\_detection}!pose\_and\_orientation@{pose\_and\_orientation}}
\doxysubsubsection{\texorpdfstring{object\_detection()}{object\_detection()}}
{\footnotesize\ttfamily  None pose\+\_\+and\+\_\+orientation.\+object\+\_\+detection (\begin{DoxyParamCaption}\item[{Image}]{image\+\_\+msg,  }\item[{Point\+Cloud2}]{point\+\_\+cloud2\+\_\+msg,  }\item[{}]{inputs }\end{DoxyParamCaption})}



The function finds the position of the object with respect to the world frame. 

Inputs\+:
\begin{DoxyItemize}
\item image\+\_\+msg\+: image published by the zed camera in R\+Viz
\item point\+\_\+cloud2\+\_\+msg\+: data published by the Point\+Cloud2
\item recognized\+\_\+bricks\+: information coming from the Y\+O\+LO model
\end{DoxyItemize}

Outputs\+:
\begin{DoxyItemize}
\item centre
\item orientation 
\end{DoxyItemize}\mbox{\Hypertarget{namespacepose__and__orientation_a2247b4d9578547ab2f2d689761ec7749}\label{namespacepose__and__orientation_a2247b4d9578547ab2f2d689761ec7749}} 
\index{pose\_and\_orientation@{pose\_and\_orientation}!prepare\_dataset@{prepare\_dataset}}
\index{prepare\_dataset@{prepare\_dataset}!pose\_and\_orientation@{pose\_and\_orientation}}
\doxysubsubsection{\texorpdfstring{prepare\_dataset()}{prepare\_dataset()}}
{\footnotesize\ttfamily def pose\+\_\+and\+\_\+orientation.\+prepare\+\_\+dataset (\begin{DoxyParamCaption}\item[{}]{source,  }\item[{}]{target,  }\item[{}]{voxel\+\_\+size }\end{DoxyParamCaption})}



This function simply prepares all the pointclouds (the source one and the target one). 

The previously declared \textquotesingle{}prepare\+\_\+dataset\textquotesingle{} is used for each.

Inputs\+:
\begin{DoxyItemize}
\item source\+: the source pointcloud
\item target\+: the target pointcloud
\item voxel\+\_\+size\+: the size at which we desire to downsample
\end{DoxyItemize}

Outputs\+:
\begin{DoxyItemize}
\item source\+: the source pointcloud
\item target\+: the target pointcloud
\item source\+\_\+down\+: the prepared (downsampled) source pointcloud
\item target\+\_\+down\+: the prepared (downsampled) target pointcloud
\item source\+\_\+fpfh\+: F\+P\+FH feature for the points of the source pointcloud
\item target\+\_\+fpfh\+: F\+P\+FH feature for the points of the target pointcloud 
\end{DoxyItemize}\mbox{\Hypertarget{namespacepose__and__orientation_a4caae50b1147e3387534a469ae6e6125}\label{namespacepose__and__orientation_a4caae50b1147e3387534a469ae6e6125}} 
\index{pose\_and\_orientation@{pose\_and\_orientation}!preprocess\_point\_cloud@{preprocess\_point\_cloud}}
\index{preprocess\_point\_cloud@{preprocess\_point\_cloud}!pose\_and\_orientation@{pose\_and\_orientation}}
\doxysubsubsection{\texorpdfstring{preprocess\_point\_cloud()}{preprocess\_point\_cloud()}}
{\footnotesize\ttfamily def pose\+\_\+and\+\_\+orientation.\+preprocess\+\_\+point\+\_\+cloud (\begin{DoxyParamCaption}\item[{}]{pcd,  }\item[{}]{voxel\+\_\+size }\end{DoxyParamCaption})}



This function downsamples the point cloud, estimates normals, then computes a F\+P\+FH feature for each point. 

The F\+P\+FH feature is a 33-\/dimensional vector that describes the local geometric property of a point.

Inputs\+:
\begin{DoxyItemize}
\item pcd\+: the pointcloud
\item voxel\+\_\+size\+: the size at which we desire to downsample
\end{DoxyItemize}

Outputs\+:
\begin{DoxyItemize}
\item pcd\+\_\+down\+: the downsampled pointcloud
\item pcd\+\_\+fpfh\+: F\+P\+FH feature for the point 
\end{DoxyItemize}\mbox{\Hypertarget{namespacepose__and__orientation_a509656a47056d2ef1304dd029fd26d6a}\label{namespacepose__and__orientation_a509656a47056d2ef1304dd029fd26d6a}} 
\index{pose\_and\_orientation@{pose\_and\_orientation}!rotation\_matrix\_to\_euler\_angles@{rotation\_matrix\_to\_euler\_angles}}
\index{rotation\_matrix\_to\_euler\_angles@{rotation\_matrix\_to\_euler\_angles}!pose\_and\_orientation@{pose\_and\_orientation}}
\doxysubsubsection{\texorpdfstring{rotation\_matrix\_to\_euler\_angles()}{rotation\_matrix\_to\_euler\_angles()}}
{\footnotesize\ttfamily def pose\+\_\+and\+\_\+orientation.\+rotation\+\_\+matrix\+\_\+to\+\_\+euler\+\_\+angles (\begin{DoxyParamCaption}\item[{}]{R }\end{DoxyParamCaption})}



This function converts a rotation matrix into euler angles (R\+PY). 

Inputs\+:
\begin{DoxyItemize}
\item R\+: the rotation matrix
\end{DoxyItemize}

Outputs\+:
\begin{DoxyItemize}
\item x\+: roll angle
\item y\+: pitch angle
\item z\+: yaw angle 
\end{DoxyItemize}